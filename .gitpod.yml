# .gitpod.yml
tasks:
  - name: Setup Python 3.11
    init: |
      # Instala pyenv se necess√°rio
      curl https://pyenv.run | bash
      export PYENV_ROOT="$HOME/.pyenv"
      export PATH="$PYENV_ROOT/bin:$PATH"
      eval "$(pyenv init -)"
      
      # For√ßa instala√ß√£o do Python 3.11.9 sem prompts
      pyenv install -f 3.11.9
      pyenv global 3.11.9
      python --version

  - name: Install Dependencies
    init: |
      set -e # Sai imediatamente em caso de erro
      echo "üêç Instalando MetaGPT e depend√™ncias..."
      
      # Configura ambiente Python
      export PYENV_ROOT="$HOME/.pyenv"
      export PATH="$PYENV_ROOT/bin:$PATH"
      eval "$(pyenv init -)"
      
      # Instala depend√™ncias
      pip install --upgrade pip setuptools wheel
      pip install numpy==1.26.0
      pip install metagpt
      
      # Verifica instala√ß√£o
      if ! which metagpt >/dev/null; then
        echo "‚ùå Falha na instala√ß√£o do MetaGPT!"
        exit 1
      fi
      gp sync-done deps_installed

  - name: Welcome
    command: |
      gp sync-await deps_installed
      echo -e "\n\033[32m‚úÖ Tudo pronto! Use:\033[0m"
      echo "metagpt 'sua pergunta'"
      echo -e "\n\033[33müëâ Configure suas API keys em:\033[0m"
      echo "https://gitpod.io/user/variables"

# List the ports to expose. Learn more: https://www.gitpod.io/docs/configure/workspaces/ports
ports:
  - name: Frontend
    description: Port 3000 for the frontend
    port: 3000
    onOpen: open-preview

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart
